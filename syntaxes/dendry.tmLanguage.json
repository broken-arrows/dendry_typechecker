{
  "name": "Dendry",
  "scopeName": "source.dendry",
  "patterns": [
    {
      "include": "#scene-id-declaration"
    },
    {
      "include": "#js-property"
    },
    {
      "include": "#js-block"
    },
    {
      "include": "#comments"
    },
    {
      "include": "#scene-declaration"
    },
    {
      "include": "#quality-declaration"
    },
    {
      "include": "#choice"
    },
    {
      "include": "#javascript-inline"
    },
    {
      "include": "#property"
    }
  ],    "repository": {

      "scene-id-declaration": {
        "match": "^(@)([a-zA-Z0-9_]+)(?=\\s|$)",
        "captures": {
          "1": { "name": "keyword.operator.dendry" },
          "2": { "name": "entity.name.function.dendry" }
        }
      },
      "js-property": {
        "name": "meta.property.js.dendry",      "begin": "(^\\s*(?:id|title|subtitle|tags|order|frequency|max-visits|min-choices|max-choices|new-page|signal|content|on-arrival|on-display|on-departure|view-if|choose-if|priority|unavailable-subtitle|name|initial|min|max|on-choose|go-to|set-jump|is-special|set-bg|is-hand|card-image|face-image|is-deck|max-cards|is-pinned-card|is-card)):\\s*(\\{!)",
      "end": "(!\\})",
      "beginCaptures": {
        "1": { "name": "variable.parameter.dendry" },
        "2": { "name": "punctuation.section.embedded.begin.js" }
      },
      "endCaptures": {
        "1": { "name": "punctuation.section.embedded.end.js" }
      },
      "patterns": [
        {
          "include": "source.js"
        }
      ]
    },
    "js-block": {
      "name": "meta.embedded.block.javascript.dendry",
      "begin": "\\{!\\s*",
      "end": "\\s*!\\}",
      "patterns": [
        {
          "include": "source.js"
        }
      ]
    },
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.dendry",
          "match": "^\\s*#.*$"
        }
      ]
    },
    "scene-declaration": {
      "match": "^(@)(scene|root)\\s+([a-zA-Z0-9_]+)$",
      "captures": {
        "1": { "name": "keyword.operator.dendry" },
        "2": { "name": "keyword.control.dendry" },
        "3": { "name": "entity.name.function.dendry" }
      }
    },
    "quality-declaration": {
      "match": "^(@)(quality)\\s+([a-zA-Z0-9_]+)?$",
      "captures": {
        "1": { "name": "keyword.operator.dendry" },
        "2": { "name": "keyword.control.dendry" },
        "3": { "name": "entity.name.type.dendry" }
      }
    },
    "property": {
      "match": "^\\s*(id|title|subtitle|tags|order|frequency|max-visits|min-choices|max-choices|new-page|signal|content|on-arrival|on-display|on-departure|view-if|choose-if|priority|unavailable-subtitle|name|initial|min|max|on-choose|go-to|set-jump|is-special|set-bg|is-hand|card-image|face-image|is-deck|max-cards|is-pinned-card|is-card):\\s*(.+)$",
      "captures": {
        "1": { "name": "variable.parameter.dendry" },
        "2": { "name": "string.unquoted.dendry" }
      }
    },
    "choice": {
      "match": "^\\s*(-|\\*)\\s+(@)?([a-zA-Z0-9_.]+)(?::\\s*(.+))?$",
      "captures": {
        "1": { "name": "keyword.operator.dendry" },
        "2": { "name": "keyword.operator.dendry" },
        "3": { "name": "entity.name.function.dendry" },
        "4": { "name": "string.unquoted.dendry" }
      }
    },
    "javascript-inline": {
      "begin": "(?<=:)\\s*(return|if|function|Q\\.|S\\.|V\\.|P\\.)",
      "end": "$",
      "name": "meta.embedded.block.javascript",
      "patterns": [
        {
          "include": "source.js"
        }
      ]
    }
  }
}
